% Options for packages loaded elsewhere
% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  12pt,
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}
\usepackage{xcolor}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{5}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
  \setmainfont[]{Times New Roman}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother


\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother


% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}



\setlength{\emergencystretch}{3em} % prevent overfull lines

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}



 


\usepackage{tcolorbox}
\usepackage{amssymb}
\usepackage{yfonts}
\usepackage{bm}


\newtcolorbox{greybox}{
  colback=white,
  colframe=blue,
  coltext=black,
  boxsep=5pt,
  arc=4pt}
  
\newcommand{\sectionbreak}{\clearpage}

 
\newcommand{\ds}[4]{\sum_{{#1}=1}^{#3}\sum_{{#2}=1}^{#4}}
\newcommand{\us}[3]{\mathop{\sum\sum}_{1\leq{#2}<{#1}\leq{#3}}}

\newcommand{\ol}[1]{\overline{#1}}
\newcommand{\ul}[1]{\underline{#1}}

\newcommand{\amin}[1]{\mathop{\text{argmin}}_{#1}}
\newcommand{\amax}[1]{\mathop{\text{argmax}}_{#1}}

\newcommand{\ci}{\perp\!\!\!\perp}

\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\mb}[1]{\mathbb{#1}}
\newcommand{\mf}[1]{\mathfrak{#1}}

\newcommand{\eps}{\epsilon}
\newcommand{\lbd}{\lambda}
\newcommand{\alp}{\alpha}
\newcommand{\df}{=:}
\newcommand{\am}[1]{\mathop{\text{argmin}}_{#1}}
\newcommand{\ls}[2]{\mathop{\sum\sum}_{#1}^{#2}}
\newcommand{\ijs}{\mathop{\sum\sum}_{1\leq i<j\leq n}}
\newcommand{\jis}{\mathop{\sum\sum}_{1\leq j<i\leq n}}
\newcommand{\sij}{\sum_{i=1}^n\sum_{j=1}^n}
	
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\usepackage{amsthm}
\theoremstyle{plain}
\newtheorem{lemma}{Lemma}[section]
\theoremstyle{remark}
\AtBeginDocument{\renewcommand*{\proofname}{Proof}}
\newtheorem*{remark}{Remark}
\newtheorem*{solution}{Solution}
\newtheorem{refremark}{Remark}[section]
\newtheorem{refsolution}{Solution}[section]
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Majorizing Least Squares Loss functions},
  pdfauthor={Jan de Leeuw},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{Majorizing Least Squares Loss functions}
\author{Jan de Leeuw}
\date{October 16, 2025}
\begin{document}
\maketitle
\begin{abstract}
TBD
\end{abstract}

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{3}
\tableofcontents
}

\sectionbreak

\textbf{Note:} This is a working manuscript which will be
expanded/updated frequently. All suggestions for improvement are
welcome. All Rmd, tex, html, pdf, R, and C files are in the public
domain. Attribution will be appreciated, but is not required. The files
can be found at \url{https://github.com/deleeuw/majorls}

\sectionbreak

\section{Introduction}\label{introduction}

The data of our problem are

\begin{itemize}
\tightlist
\item
  \(x\), a vector with \(n\) elements,
\item
  \(W\), a positive semi-definite matrix of order \(n\),
\item
  \(\mathcal{Y}\), some subset of \(\mathbb{R}^n\).
\end{itemize}

Define the least squares loss function \[
\sigma(y):=\tfrac12(x-y)'W(x-y).
\] Our problem is to minimize \(\sigma\) over \(y\in\mathcal{Y}\).

\sectionbreak

\section{Majorization}\label{majorization}

\subsection{General}\label{general}

Suppose \(\tilde y\) is some element of \(\mathcal{Y}\), with loss
function value \(\sigma(\tilde y)\). We want to find an element of
\(\mathcal{Y}\) which is better than \(\tilde y\), i.e.~has a lower
value of loss.

\begin{lemma}[]\protect\hypertarget{lem-major}{}\label{lem-major}

Suppose \(V\gtrsim W\) in the Loewner sense, i.e \(V-W\) is positive
semidefinite. Define \(z:=V^{-1}W(x-\tilde y)\) and
\(y^+:=\tilde y+\theta z\), with \(0\leq\theta\leq 2\). Then
\(\sigma(y^+)\leq\sigma(\tilde y)\).

\end{lemma}

\begin{proof}
Because \(y=\tilde y+(y-\tilde y)\) we have \begin{equation}
\sigma(y)=
\sigma(\tilde y)-2(y-\tilde y)'W(x-\tilde y)+(y-\tilde y)'W(y - \tilde y).
\end{equation} Define \begin{equation}
\eta(y,\tilde y):=
\sigma(\tilde y)-2(y-\tilde y)'W(x-\tilde y)+(y-\tilde y)'V(y - \tilde y).
\end{equation} then \(\sigma(y)\leq\eta(y,\tilde y)\) with equality if
\(y=\tilde y\). Now \(y^+-\tilde y=\theta z\) and thus \begin{equation}
\sigma(y^+)\leq\eta(y^+,\tilde y)=\sigma(\tilde y)+(\theta^2-2\theta)z'Vz\leq \sigma(\tilde y).
\end{equation}
\end{proof}

majorization This is the \emph{sandwich inequality} from majorization
theory, which says that a majorization step decreases the loss function
value.

Suppose \(y^+\neq\tilde y\). Then the inequality
\(\sigma(y^+)\leq\eta(y^+,\tilde y)\) is strict if the minimum of
\(\eta(y,\tilde y)\) is unique, which will be the case if \(V\) is
positive definite. The second inequality
\(\eta(y^+,\tilde y)\leq\eta(\tilde y,\tilde y)\) is strict if \(V-W\)
is positive definite. Since \(W\) is positive semidefinite both
inequalities are strict if \(V-W\) is positive definite.

\begin{equation}
y^{(k+1)}\in\mathop{\text{argmin}}_{y\in\mathcal{Y}}\eta(y,y^{(k)})
\end{equation}

Completing the square. Let
\(z:=V^{-1}W(x-\tilde y)=V^{-1}\nabla\sigma(\tilde y)\) \[
\eta(y,\tilde y)=
\sigma(\tilde y)-2(y-\tilde y)'Vz+(y-\tilde y)'V(y - \tilde y)=
\sigma(\tilde y)+(y-(\tilde y+z))'V(y-(\tilde y+z))-z'Vz
\] \[
y^{(k+1)}\in\Pi_{\mathcal{Y}}^V(\tilde y+z)
\] \[
z=\theta V^{-1}W(x-\tilde y)
\]

\subsection{Scalar Majorization}\label{scalar-majorization}

\(V=\nu D\). \(\nu D\gtrsim W\) \(\nu I\gtrsim D^{-1}W\)
\(\nu\geq\lambda_{\text{max}}(D^{-1}W)\)

\subsection{Diagonal Majorization}\label{diagonal-majorization}

Find the smallest diagonal matrix \(V\gtrsim W\). We define ``smallest''
as minimizing the trace \(\text{tr}\ V\). Minimizing \(f\) over
\(V\gtrsim W\) is a convex problem, which we can formulate as the linear
semi-infinite problem of minimizing \(f\) over \(V\) that satisfies
\(x'Vx\geq x'Wx\) for all \(x'x=1\).

The R program myCutter() is a simple cutting plane algorithm to do just
that. It is not optimized in any way, and it will probably fail for
large \(n\). The basic idea is to approximate the feasible region
\(V\gtrsim W\) from the outside by a compact convex polyhedron. We start
with the \(n\) inequalities \(v_{ii}\geq w_{ii}\). Then minimize the
objective function by linear programming (using lpSolve, Berkelaar
(\citeproc{ref-berkelaar_24}{2024})). This will give a minimum attained
at a vertex of the polyhedron. At this vertex the smallest eigenvalue
(computed with RSpectra, Qiu and Mei (\citeproc{ref-qiu_mei_24}{2024}))
of \(V-W\) will be negative. If \(x\) is the corresponding normalized
eigenvector then we add the contraint \(x'Vx\geq x'Wx\) and solve the
linear program with this added inequality, which cuts off the vertex
that defined the current solution. The minimum valueof the loss function
will increase, and we continue until we have convergence.

Thus the number of inequality constraints increases by one in each
iteration. The algorithm is wasteful because it does not prune the
inequalities, and because each linear programming solution is started
from scratch, without taking into account that two successive programs
only differ by one inequality constraint.

\subsection{Examples}\label{examples}

\subsubsection{Linear Regression}\label{linear-regression}

\subsubsection*{Low-rank Approximation}\label{low-rank-approximation}
\addcontentsline{toc}{subsubsection}{Low-rank Approximation}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\bibitem[\citeproctext]{ref-berkelaar_24}
Berkelaar, Michel. 2024. \emph{lpSolve: Interface to 'Lp\_solve' v. 5.5
to Solve Linear/Integer Programs}.
\url{https://doi.org/10.32614/CRAN.package.lpSolve}.

\bibitem[\citeproctext]{ref-qiu_mei_24}
Qiu, Y., and J. Mei. 2024. \emph{{RSpectra: Solvers for Large-Scale
Eigenvalue and SVD Problems}}.
\url{https://CRAN.R-project.org/package=RSpectra}.

\end{CSLReferences}




\end{document}
